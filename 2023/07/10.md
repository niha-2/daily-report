# 2023/07/10  の日報

## 取り組んだ課題

- SQL
  - インプット課題（達人に学ぶDB設計）７章途中まで
  - アウトプット課題途中まで

## わかったこと

- SQL
  - ３層スキーマ（外部スキーマ、概念スキーマ、内部スキーマ）
  - 論理設計（概念スキーマ）は物理設計（内部スキーマ）に先立つ
    - 論理設計：エンティティ抽出->エンティティ定義->正規化->ER図作成
    - 物理設計：テーブル定義->インデックス定義->ハードウェアサイジング->ストレージ冗長構成決定->ファイルの物理配置決定
  - バックアップ設計
    - フルバックアップ
    - 差分バックアップ
      - 差分バックアップ
      - 増分バックアップ
    - 「フルバックアップ＋差分バックアップ」or「フルバックアップ＋増分バックアップ」が一般的
  - リカバリ設計
    - リストア：バックアップファイルを戻す
    - リカバリ：トランザクションファイルを適用して変更分を反映する
    - ロールフォワード：DBサーバに残っているトランザクションログを適用する
  - 正規化：データの冗長性をなくす
    - 第１正規化：一つのセルの中に一つの値しか含まない
    - 第２正規化：部分関数従属をなくす
    - 第３正規化：推移的関数従属をなくす
  - ER図（Entity-Relationship Diagram）
    - テーブル同士がどういう関係にあるのかを表す
    - ER図の書き方は、IE（Information Engineering）表記法とIDEFIXの２つが代表的
    - ER図を書くには、テーブル同士の関係を次の３パターンに分けることが重要
      - １対１
      - １対多
      - 多対多
    - 多対多の場合、２つのテーブル同士を結合することが出来ない->関連実体（２つのテーブルの主キーを組み合わせたキーを主キーに持つテーブル）を作ることが多い
  - 論理設計とパフォーマンス
    - 正規化と検索SQLのパフォーマンスは強いトレードオフの関係（正規化されているとSQLで結合が必要になる）
    - 原則として非正規化は許さず、非正規化は最後の手段とする
    - 非正規化のリスク
      - 検索パフォーマンスは上がるが、更新パフォーマンスを低下させる
      - データのリアルタイム性を低下させる
      - 後続の工程で設計変更すると手戻りが大きい
  - DBのパフォーマンス
    - パフォーマンスを決める３つの要因
      - ディスクI/Oの分散（RAID）
      - SQLによる結合（正規化）
      - インデックスと統計情報
    - インデックス
      - キーとそれに結びつく情報（データへのポインタ）の形式の配列(x, α)
      - DBMS内にテーブルと独立して保持されるオブジェクト
    - インデックス設計
    - 統計情報
      - SQLの最適なアクセスパスを見つけるための地図情報
      - DBMSにアクセス経路選択を一任するコストベースと呼ばれるアーキテクチャが現在は主流


## 次やること

- Ruby
  - アウトプット課題
- Linux
  - アウトプット課題

## 感想

- 正規化の方法が論理的に掴めてきた
- パフォーマンスとの関係も今後学んでいきたい

## 学習時間

- today: 10.0h
- total: 176.5h
